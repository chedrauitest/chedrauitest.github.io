<!DOCTYPE html>
<html lang="es">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PDSJ3VT8');</script>
<!-- End Google Tag Manager -->
<head>
    <meta charset="UTF-8">
    <title>Mi Carrito</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PDSJ3VT8"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <header>
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h1>Mi Carrito</h1>
            <a href="index.html" style="color:white;">Seguir comprando</a>
        </div>
    </header>

    <div class="container">
        <div id="lista-carrito" class="detail-view">
            </div>

        <div style="text-align: right; margin-top: 20px;">
            <h2 id="total-carrito">Total: $0.00</h2>
            <button onclick="window.location.href='pago.html'" id="btn-pagar">Proceder al Pago</button>
        </div>
    </div>

    <script src="data.js"></script>
    <script>
        const contenedor = document.getElementById('lista-carrito');
        const itemsCarrito = Carrito.obtener();
        
        if (itemsCarrito.length === 0) {
            contenedor.innerHTML = "<p>El carrito está vacío.</p>";
            document.getElementById('btn-pagar').style.display = 'none';
        } else {
            let html = '<table style="width:100%; text-align:left; border-collapse: collapse;">';
            html += '<tr><th>Producto</th><th>Cant.</th><th>Subtotal</th></tr>';
            
            itemsCarrito.forEach(item => {
                const prod = PRODUCTOS.find(p => p.id === item.id);
                const subtotal = prod.precio * item.cantidad;
                html += `
                    <tr style="border-bottom:1px solid #eee;">
                        <td style="padding:10px;">${prod.nombre}</td>
                        <td>x${item.cantidad}</td>
                        <td>${formatMoney(subtotal)}</td>
                    </tr>
                `;
            });
            html += '</table>';
            contenedor.innerHTML = html;
            
            document.getElementById('total-carrito').innerText = `Total: ${formatMoney(Carrito.calcularTotal())}`;
        }
    </script>
    
    <!-- Start of async Intercept tracking code -->
    <script type="text/javascript" src="https://intercept-widget.questionpro.eu/static/js/loader.js"></script>
    <script type="text/javascript"> 
       var Intercept = { apiKey: '9019d3a4-1104-4f00-b42e-49f9176f0c18'};
    </script>
    <!-- End of async Intercept tracking code -->
  
</body>
</html>
